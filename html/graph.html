<html>
<head>
  <script type="text/javascript" src="./sigma.min.js" ></script>
  <script type="text/javascript" src="./graph-data.js" ></script>
  <script type="text/javascript">

    document.addEventListener("DOMContentLoaded", function(event) { 
      
      console.log('INITIALISING');

      var g = getGraph();

      // For the sake of simplicity,
      // Filter only 30 topics, 64 keywords
      var topic   = (n) => n.type == 'TOPIC';
      var keyword = (n) => n.type == 'KEYWORD';
      g.nodes = g.nodes.filter(topic).slice(0,30)
        .concat(g.nodes.filter(keyword).slice(0,64))

      g.edges = g.edges.filter((e) => {
        g.nodes.filter((n) => n.id == e.in).count>0 &&
        g.nodes.filter((n) => n.id == e.out).count>0
      })

      var S = new sigma({ graph: g, container: 'container'});
      S.settings({
        edgeColor:        'default',
        defaultEdgeColor: '#A4A4A4'
      });

      // Draw the graph
      console.log('REDRAWING CANVAS');
      console.log(S.graph.nodes.length, ' vertices to render');
      S.refresh();
    });

  </script>
</head>
<body style="width:100%;height:100%;margin:0;padding:0">
  <div id="container" style="width:100%;height:100%;margin:0;padding:0">
    <!-- -->
  </div>
</body>
</html>